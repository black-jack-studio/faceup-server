# Render Blueprint for FaceUp Blackjack
# Automates deployment configuration on Render
# See: https://render.com/docs/blueprint-spec

services:
  - type: web
    name: faceup-blackjack
    env: node
    region: frankfurt  # EU region (closest for France)
    plan: free         # Upgrade to 'starter' for 24/7 uptime
    branch: main

    # ---- Build & Start ----
    buildCommand: npm install && npm install vite esbuild tsx --save-dev && npm run build
    startCommand: node dist/index.js

    # ---- Health check ----
    healthCheckPath: /api/health

    # ---- Environment ----
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 10000
      - key: USE_SUPABASE
        value: true

      # ðŸš¨ Secrets: Ã  dÃ©finir uniquement depuis le Dashboard Render (jamais ici)
      # - key: SESSION_SECRET
      # - key: VITE_SUPABASE_URL
      # - key: VITE_SUPABASE_ANON_KEY
      # - key: SUPABASE_SERVICE_ROLE_KEY
      # - key: SUPABASE_DB_PASSWORD
      # - key: STRIPE_SECRET_KEY
      # - key: VITE_STRIPE_PUBLISHABLE_KEY
      # - key: PAYPAL_CLIENT_ID
      # - key: PAYPAL_CLIENT_SECRET

    # ---- Auto Deploy ----
    autoDeploy: true

    # ---- Logging ----
    logLevel: info
