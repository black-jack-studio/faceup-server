Parfait ğŸ‘ je tâ€™ai reformulÃ© ton prompt pour quâ€™il soit directement actionnable par ton dev, en intÃ©grant lâ€™utilisation des PNGs que tu as crÃ©Ã©s (vert = commun, bleu = rare, violet = super rare, jaune = lÃ©gendaire), leur persistance en DB, leur affichage dans la boutique et la librairie joueur, ainsi que la gestion des raretÃ©s avec pastilles.

â¸»

ğŸ”¥ Nouveau prompt pour ton dev

Sujet : IntÃ©gration complÃ¨te des dos de cartes custom (PNG) + boutique + tirage + librairie

On part sur une approche dynamique (object storage + DB) afin que les dos soient stockÃ©s en PNG (400Ã—560 px, ratio 5:7, fond transparent) et accessibles Ã  chaud, sans re-publi. Les fichiers actuels (commune verte, rare bleue, super rare violette, lÃ©gendaire jaune) doivent Ãªtre implÃ©mentÃ©s comme premiers card backs.

â¸»

1) Affichage & jeu
	â€¢	Remplacer les placeholders (couronne moche) dans PlayingCard / OffsuitCard par cardBackImageUrl (prop obligatoire).
	â€¢	Source de vÃ©ritÃ© = DB + object storage. Aucun import statique.
	â€¢	Ajouter un sÃ©lecteur de dos dans la librairie joueur : lâ€™utilisateur choisit un dos actif parmi ceux possÃ©dÃ©s â†’ ce dos sâ€™affiche partout (tables, lobby, parties).
	â€¢	Les dos non possÃ©dÃ©s sâ€™affichent visibles dans le shop et la collection avec badge Ã€ acheter.

â¸»

2) ModÃ¨le de donnÃ©es (mis Ã  jour)

CardBacks(id, name, rarity, image_url, price_coins, created_at)
UserCardBacks(user_id, card_back_id, acquired_at)    -- inventaire joueur
UserProfile(user_id, active_card_back_id)            -- dos actif
ShopOffers(id, card_back_id, start_at, end_at, is_featured)
GachaPacks(id, name, weights_json, price_coins)
Purchases(id, user_id, item_type, item_id, price_coins, created_at)

âš ï¸ RaretÃ© = ENUM : "COMMON", "RARE", "SUPER_RARE", "LEGENDARY".

â¸»

3) Boutique & achats
	â€¢	Achat direct : si UserCardBacks ne contient pas la carte â†’ bouton Acheter (ajoute en DB, dÃ©bite coins, toast succÃ¨s).
	â€¢	PossÃ©dÃ© : badge PossÃ©dÃ© + bouton Ã‰quiper (set UserProfile.active_card_back_id).
	â€¢	Pas assez de coins : CTA Acheter des coins.
	â€¢	Chaque carte dans le shop/collection doit afficher une pastille colorÃ©e de raretÃ© :
	â€¢	ğŸŸ¢ vert = Commune
	â€¢	ğŸ”µ bleu = Rare
	â€¢	ğŸŸ£ violet = Super Rare
	â€¢	ğŸŸ¡ jaune = LÃ©gendaire

â¸»

4) Tirage alÃ©atoire (gacha)
	â€¢	Ã‰cran Pack â†’ achat en coins â†’ animation reveal.
	â€¢	Logique :
	1.	Tirer une raretÃ© via weights_json.
	2.	SÃ©lectionner un dos de cette raretÃ© non possÃ©dÃ© â†’ si dup, donner refund en coins (ex: 20%).
	3.	Inscrire dans UserCardBacks + afficher la nouvelle carte avec animation.

Fonction pure exposÃ©e :

type Rarity = "COMMON"|"RARE"|"SUPER_RARE"|"LEGENDARY";

function drawCardBack(userId: string, packId: string): Promise<{
  wonCardBackId?: string,
  rarity: Rarity,
  dupRefundCoins?: number
}>


â¸»

5) API / services
	â€¢	GET /card-backs â†’ liste + mÃ©tas (filtre owned/unowned, inclure rarity).
	â€¢	POST /purchase/card-back {card_back_id}.
	â€¢	POST /gacha/draw {pack_id}.
	â€¢	POST /profile/set-active-card-back {card_back_id}.
	â€¢	VÃ©rifier coins + atomicitÃ© sur chaque endpoint.

â¸»

6) Ã‰tats UI
	â€¢	Collection : grilles possÃ©dÃ©s/non possÃ©dÃ©s, pastille de raretÃ©, badge Nouveau.
	â€¢	Boutique : cartes avec image PNG, prix, raretÃ©, bouton contextuel (Acheter / Ã‰quiper / PossÃ©dÃ©).
	â€¢	Librairie joueur : section claire oÃ¹ lâ€™utilisateur voit ses dos, avec raretÃ© + bouton Ã‰quiper.
	â€¢	Feedback : â€œLes dos achetÃ©s restent associÃ©s Ã  ton compte et utilisables immÃ©diatementâ€.

â¸»

7) Technique images
	â€¢	Les PNGs fournis (commune, rare, super rare, lÃ©gendaire) sont Ã  uploader dans object storage (Replit/Cloudflare/Supabase).
	â€¢	En DB : CardBacks.image_url = lien public.
	â€¢	UI : thumbnails (200px) pour shop/collection, full (400Ã—560) pour in-game.
	â€¢	Mettre en place cache + placeholder blur pour fluiditÃ©.

â¸»

8) CritÃ¨res dâ€™acceptation

âœ… Les 4 PNGs fournis remplacent tous les placeholders en jeu.
âœ… PossibilitÃ© dâ€™acheter, Ã©quiper et jouer avec nâ€™importe quel dos possÃ©dÃ©.
âœ… Librairie joueur fonctionne (inventaire persistant, dos actifs).
âœ… Shop montre les cartes non possÃ©dÃ©es avec raretÃ© et prix.
âœ… Tirage gacha = raretÃ© pondÃ©rÃ©e, refund si doublon.
âœ… Persistance garantie (mÃªme aprÃ¨s reconnexion).

â¸»

ğŸ‘‰ Ce prompt donne tout : intÃ©gration des PNG, mÃ©moire par utilisateur, boutique, librairie avec pastilles raretÃ©, et gacha.

Veux-tu que je tâ€™ajoute aussi un seed JSON prÃªt Ã  insÃ©rer en DB (avec tes 4 PNGs et leurs raretÃ©s/prix) pour que ton dev puisse plugger direct ?